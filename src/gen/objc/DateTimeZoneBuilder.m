//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/andrewebling/Laundrapp/Joda-time-Project/joda-time/src/main/java/org/joda/time/tz/DateTimeZoneBuilder.java
//

#include "CachedDateTimeZone.h"
#include "Chronology.h"
#include "DateTime.h"
#include "DateTimeField.h"
#include "DateTimeUtils.h"
#include "DateTimeZone.h"
#include "DateTimeZoneBuilder.h"
#include "FixedDateTimeZone.h"
#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "ISOChronology.h"
#include "Period.h"
#include "PeriodType.h"
#include "ZoneInfoCompiler.h"
#include "java/io/DataInput.h"
#include "java/io/DataInputStream.h"
#include "java/io/DataOutput.h"
#include "java/io/DataOutputStream.h"
#include "java/io/IOException.h"
#include "java/io/InputStream.h"
#include "java/io/OutputStream.h"
#include "java/io/PrintStream.h"
#include "java/lang/ArithmeticException.h"
#include "java/lang/ArrayIndexOutOfBoundsException.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/Integer.h"
#include "java/lang/Long.h"
#include "java/lang/System.h"
#include "java/lang/UnsupportedOperationException.h"
#include "java/text/DateFormatSymbols.h"
#include "java/util/ArrayList.h"
#include "java/util/Arrays.h"
#include "java/util/HashSet.h"
#include "java/util/Iterator.h"
#include "java/util/Locale.h"
#include "java/util/Set.h"

@implementation OrgJodaTimeTzDateTimeZoneBuilder

+ (OrgJodaTimeDateTimeZone *)readFromWithJavaIoInputStream:(JavaIoInputStream *)inArg
                                              withNSString:(NSString *)id_ {
  if ([inArg conformsToProtocol: @protocol(JavaIoDataInput)]) {
    return [OrgJodaTimeTzDateTimeZoneBuilder readFromWithJavaIoDataInput:(id<JavaIoDataInput>) check_protocol_cast(inArg, @protocol(JavaIoDataInput)) withNSString:id_];
  }
  else {
    return [OrgJodaTimeTzDateTimeZoneBuilder readFromWithJavaIoDataInput:(id<JavaIoDataInput>) check_protocol_cast([[JavaIoDataInputStream alloc] initWithJavaIoInputStream:inArg], @protocol(JavaIoDataInput)) withNSString:id_];
  }
}

+ (OrgJodaTimeDateTimeZone *)readFromWithJavaIoDataInput:(id<JavaIoDataInput>)inArg
                                            withNSString:(NSString *)id_ {
  {
    OrgJodaTimeDateTimeZone *fixed;
    switch ([((id<JavaIoDataInput>) nil_chk(inArg)) readUnsignedByte]) {
      case 'F':
      fixed = [[OrgJodaTimeTzFixedDateTimeZone alloc] initWithNSString:id_ withNSString:[inArg readUTF] withInt:(int) [OrgJodaTimeTzDateTimeZoneBuilder readMillisWithJavaIoDataInput:inArg] withInt:(int) [OrgJodaTimeTzDateTimeZoneBuilder readMillisWithJavaIoDataInput:inArg]];
      if ([fixed isEqual:OrgJodaTimeDateTimeZone_get_UTC_()]) {
        fixed = OrgJodaTimeDateTimeZone_get_UTC_();
      }
      return fixed;
      case 'C':
      return [OrgJodaTimeTzCachedDateTimeZone forZoneWithOrgJodaTimeDateTimeZone:[OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone readFromWithJavaIoDataInput:inArg withNSString:id_]];
      case 'P':
      return [OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone readFromWithJavaIoDataInput:inArg withNSString:id_];
      default:
      @throw [[JavaIoIOException alloc] initWithNSString:@"Invalid encoding"];
    }
  }
}

+ (void)writeMillisWithJavaIoDataOutput:(id<JavaIoDataOutput>)outArg
                               withLong:(long long int)millis {
  if (millis % (30 * 60000LL) == 0) {
    long long int units = millis / (30 * 60000LL);
    if ((((long long) (((uint64_t) units) << (64 - 6))) >> (64 - 6)) == units) {
      [((id<JavaIoDataOutput>) nil_chk(outArg)) writeByteWithInt:(int) (units & (int) 0x3f)];
      return;
    }
  }
  if (millis % 60000LL == 0) {
    long long int minutes = millis / 60000LL;
    if ((((long long) (((uint64_t) minutes) << (64 - 30))) >> (64 - 30)) == minutes) {
      [((id<JavaIoDataOutput>) nil_chk(outArg)) writeIntWithInt:(int) 0x40000000 | (int) (minutes & (int) 0x3fffffff)];
      return;
    }
  }
  if (millis % 1000LL == 0) {
    long long int seconds = millis / 1000LL;
    if ((((long long) (((uint64_t) seconds) << (64 - 38))) >> (64 - 38)) == seconds) {
      [((id<JavaIoDataOutput>) nil_chk(outArg)) writeByteWithInt:(int) 0x80 | (int) ((seconds >> 32) & (int) 0x3f)];
      [outArg writeIntWithInt:(int) (seconds & (int) 0xffffffff)];
      return;
    }
  }
  [((id<JavaIoDataOutput>) nil_chk(outArg)) writeByteWithInt:millis < 0 ? (int) 0xff : (int) 0xc0];
  [outArg writeLongWithLong:millis];
}

+ (long long int)readMillisWithJavaIoDataInput:(id<JavaIoDataInput>)inArg {
  int v = [((id<JavaIoDataInput>) nil_chk(inArg)) readUnsignedByte];
  {
    long long int w;
    switch (v >> 6) {
      case 0:
      default:
      v = (v << (32 - 6)) >> (32 - 6);
      return v * (30 * 60000LL);
      case 1:
      v = (v << (32 - 6)) >> (32 - 30);
      v |= ([inArg readUnsignedByte]) << 16;
      v |= ([inArg readUnsignedByte]) << 8;
      v |= ([inArg readUnsignedByte]);
      return v * 60000LL;
      case 2:
      w = ((long long) (((uint64_t) ((long long int) v)) << (64 - 6))) >> (64 - 38);
      w |= ([inArg readUnsignedByte]) << 24;
      w |= ([inArg readUnsignedByte]) << 16;
      w |= ([inArg readUnsignedByte]) << 8;
      w |= ([inArg readUnsignedByte]);
      return w * 1000LL;
      case 3:
      return [inArg readLong];
    }
  }
}

+ (OrgJodaTimeDateTimeZone *)buildFixedZoneWithNSString:(NSString *)id_
                                           withNSString:(NSString *)nameKey
                                                withInt:(int)wallOffset
                                                withInt:(int)standardOffset {
  if ([@"UTC" isEqual:id_] && [((NSString *) nil_chk(id_)) isEqual:nameKey] && wallOffset == 0 && standardOffset == 0) {
    return OrgJodaTimeDateTimeZone_get_UTC_();
  }
  return [[OrgJodaTimeTzFixedDateTimeZone alloc] initWithNSString:id_ withNSString:nameKey withInt:wallOffset withInt:standardOffset];
}

- (instancetype)init {
  if (self = [super init]) {
    iRuleSets_ = [[JavaUtilArrayList alloc] initWithInt:10];
  }
  return self;
}

- (OrgJodaTimeTzDateTimeZoneBuilder *)addCutoverWithInt:(int)year
                                               withChar:(unichar)mode
                                                withInt:(int)monthOfYear
                                                withInt:(int)dayOfMonth
                                                withInt:(int)dayOfWeek
                                            withBoolean:(BOOL)advanceDayOfWeek
                                                withInt:(int)millisOfDay {
  if ([((JavaUtilArrayList *) nil_chk(iRuleSets_)) size] > 0) {
    OrgJodaTimeTzDateTimeZoneBuilder_OfYear *ofYear = [[OrgJodaTimeTzDateTimeZoneBuilder_OfYear alloc] initWithChar:mode withInt:monthOfYear withInt:dayOfMonth withInt:dayOfWeek withBoolean:advanceDayOfWeek withInt:millisOfDay];
    OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *lastRuleSet = [iRuleSets_ getWithInt:[iRuleSets_ size] - 1];
    [((OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *) nil_chk(lastRuleSet)) setUpperLimitWithInt:year withOrgJodaTimeTzDateTimeZoneBuilder_OfYear:ofYear];
  }
  [iRuleSets_ addWithId:[[OrgJodaTimeTzDateTimeZoneBuilder_RuleSet alloc] init]];
  return self;
}

- (OrgJodaTimeTzDateTimeZoneBuilder *)setStandardOffsetWithInt:(int)standardOffset {
  [((OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *) nil_chk([self getLastRuleSet])) setStandardOffsetWithInt:standardOffset];
  return self;
}

- (OrgJodaTimeTzDateTimeZoneBuilder *)setFixedSavingsWithNSString:(NSString *)nameKey
                                                          withInt:(int)saveMillis {
  [((OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *) nil_chk([self getLastRuleSet])) setFixedSavingsWithNSString:nameKey withInt:saveMillis];
  return self;
}

- (OrgJodaTimeTzDateTimeZoneBuilder *)addRecurringSavingsWithNSString:(NSString *)nameKey
                                                              withInt:(int)saveMillis
                                                              withInt:(int)fromYear
                                                              withInt:(int)toYear
                                                             withChar:(unichar)mode
                                                              withInt:(int)monthOfYear
                                                              withInt:(int)dayOfMonth
                                                              withInt:(int)dayOfWeek
                                                          withBoolean:(BOOL)advanceDayOfWeek
                                                              withInt:(int)millisOfDay {
  if (fromYear <= toYear) {
    OrgJodaTimeTzDateTimeZoneBuilder_OfYear *ofYear = [[OrgJodaTimeTzDateTimeZoneBuilder_OfYear alloc] initWithChar:mode withInt:monthOfYear withInt:dayOfMonth withInt:dayOfWeek withBoolean:advanceDayOfWeek withInt:millisOfDay];
    OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *recurrence = [[OrgJodaTimeTzDateTimeZoneBuilder_Recurrence alloc] initWithOrgJodaTimeTzDateTimeZoneBuilder_OfYear:ofYear withNSString:nameKey withInt:saveMillis];
    OrgJodaTimeTzDateTimeZoneBuilder_Rule *rule = [[OrgJodaTimeTzDateTimeZoneBuilder_Rule alloc] initWithOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:recurrence withInt:fromYear withInt:toYear];
    [((OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *) nil_chk([self getLastRuleSet])) addRuleWithOrgJodaTimeTzDateTimeZoneBuilder_Rule:rule];
  }
  return self;
}

- (OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *)getLastRuleSet {
  if ([((JavaUtilArrayList *) nil_chk(iRuleSets_)) size] == 0) {
    (void) [self addCutoverWithInt:JavaLangInteger_MIN_VALUE withChar:'w' withInt:1 withInt:1 withInt:0 withBoolean:NO withInt:0];
  }
  return [iRuleSets_ getWithInt:[iRuleSets_ size] - 1];
}

- (OrgJodaTimeDateTimeZone *)toDateTimeZoneWithNSString:(NSString *)id_
                                            withBoolean:(BOOL)outputID {
  if (id_ == nil) {
    @throw [[JavaLangIllegalArgumentException alloc] init];
  }
  JavaUtilArrayList *transitions = [[JavaUtilArrayList alloc] init];
  OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *tailZone = nil;
  long long int millis = JavaLangLong_MIN_VALUE;
  int saveMillis = 0;
  int ruleSetCount = [((JavaUtilArrayList *) nil_chk(iRuleSets_)) size];
  for (int i = 0; i < ruleSetCount; i++) {
    OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *rs = [iRuleSets_ getWithInt:i];
    OrgJodaTimeTzDateTimeZoneBuilder_Transition *next = [((OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *) nil_chk(rs)) firstTransitionWithLong:millis];
    if (next == nil) {
      continue;
    }
    [self addTransitionWithJavaUtilArrayList:transitions withOrgJodaTimeTzDateTimeZoneBuilder_Transition:next];
    millis = [((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(next)) getMillis];
    saveMillis = [next getSaveMillis];
    rs = [[OrgJodaTimeTzDateTimeZoneBuilder_RuleSet alloc] initWithOrgJodaTimeTzDateTimeZoneBuilder_RuleSet:rs];
    while ((next = [rs nextTransitionWithLong:millis withInt:saveMillis]) != nil) {
      if ([self addTransitionWithJavaUtilArrayList:transitions withOrgJodaTimeTzDateTimeZoneBuilder_Transition:next]) {
        if (tailZone != nil) {
          break;
        }
      }
      millis = [((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(next)) getMillis];
      saveMillis = [next getSaveMillis];
      if (tailZone == nil && i == ruleSetCount - 1) {
        tailZone = [rs buildTailZoneWithNSString:id_];
      }
    }
    millis = [rs getUpperLimitWithInt:saveMillis];
  }
  if ([transitions size] == 0) {
    if (tailZone != nil) {
      return tailZone;
    }
    return [OrgJodaTimeTzDateTimeZoneBuilder buildFixedZoneWithNSString:id_ withNSString:@"UTC" withInt:0 withInt:0];
  }
  if ([transitions size] == 1 && tailZone == nil) {
    OrgJodaTimeTzDateTimeZoneBuilder_Transition *tr = [transitions getWithInt:0];
    return [OrgJodaTimeTzDateTimeZoneBuilder buildFixedZoneWithNSString:id_ withNSString:[((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(tr)) getNameKey] withInt:[tr getWallOffset] withInt:[tr getStandardOffset]];
  }
  OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *zone = [OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone createWithNSString:id_ withBoolean:outputID withJavaUtilArrayList:transitions withOrgJodaTimeTzDateTimeZoneBuilder_DSTZone:tailZone];
  if ([((OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *) nil_chk(zone)) isCachable]) {
    return [OrgJodaTimeTzCachedDateTimeZone forZoneWithOrgJodaTimeDateTimeZone:zone];
  }
  return zone;
}

- (BOOL)addTransitionWithJavaUtilArrayList:(JavaUtilArrayList *)transitions
withOrgJodaTimeTzDateTimeZoneBuilder_Transition:(OrgJodaTimeTzDateTimeZoneBuilder_Transition *)tr {
  int size = [((JavaUtilArrayList *) nil_chk(transitions)) size];
  if (size == 0) {
    [transitions addWithId:tr];
    return YES;
  }
  OrgJodaTimeTzDateTimeZoneBuilder_Transition *last = [transitions getWithInt:size - 1];
  if (![((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(tr)) isTransitionFromWithOrgJodaTimeTzDateTimeZoneBuilder_Transition:last]) {
    return NO;
  }
  int offsetForLast = 0;
  if (size >= 2) {
    offsetForLast = [((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk([transitions getWithInt:size - 2])) getWallOffset];
  }
  int offsetForNew = [((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(last)) getWallOffset];
  long long int lastLocal = [last getMillis] + offsetForLast;
  long long int newLocal = [tr getMillis] + offsetForNew;
  if (newLocal != lastLocal) {
    [transitions addWithId:tr];
    return YES;
  }
  (void) [transitions removeWithInt:size - 1];
  return [self addTransitionWithJavaUtilArrayList:transitions withOrgJodaTimeTzDateTimeZoneBuilder_Transition:tr];
}

- (void)writeToWithNSString:(NSString *)zoneID
     withJavaIoOutputStream:(JavaIoOutputStream *)outArg {
  if ([outArg conformsToProtocol: @protocol(JavaIoDataOutput)]) {
    [self writeToWithNSString:zoneID withJavaIoDataOutput:(id<JavaIoDataOutput>) check_protocol_cast(outArg, @protocol(JavaIoDataOutput))];
  }
  else {
    [self writeToWithNSString:zoneID withJavaIoDataOutput:(id<JavaIoDataOutput>) check_protocol_cast([[JavaIoDataOutputStream alloc] initWithJavaIoOutputStream:outArg], @protocol(JavaIoDataOutput))];
  }
}

- (void)writeToWithNSString:(NSString *)zoneID
       withJavaIoDataOutput:(id<JavaIoDataOutput>)outArg {
  OrgJodaTimeDateTimeZone *zone = [self toDateTimeZoneWithNSString:zoneID withBoolean:NO];
  if ([zone isKindOfClass:[OrgJodaTimeTzFixedDateTimeZone class]]) {
    [((id<JavaIoDataOutput>) nil_chk(outArg)) writeByteWithInt:'F'];
    [outArg writeUTFWithNSString:[((OrgJodaTimeDateTimeZone *) nil_chk(zone)) getNameKeyWithLong:0]];
    [OrgJodaTimeTzDateTimeZoneBuilder writeMillisWithJavaIoDataOutput:outArg withLong:[zone getOffsetWithLong:0]];
    [OrgJodaTimeTzDateTimeZoneBuilder writeMillisWithJavaIoDataOutput:outArg withLong:[zone getStandardOffsetWithLong:0]];
  }
  else {
    if ([zone isKindOfClass:[OrgJodaTimeTzCachedDateTimeZone class]]) {
      [((id<JavaIoDataOutput>) nil_chk(outArg)) writeByteWithInt:'C'];
      zone = [((OrgJodaTimeTzCachedDateTimeZone *) nil_chk(((OrgJodaTimeTzCachedDateTimeZone *) check_class_cast(zone, [OrgJodaTimeTzCachedDateTimeZone class])))) getUncachedZone];
    }
    else {
      [((id<JavaIoDataOutput>) nil_chk(outArg)) writeByteWithInt:'P'];
    }
    [((OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *) nil_chk(((OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *) check_class_cast(zone, [OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone class])))) writeToWithJavaIoDataOutput:outArg];
  }
}

- (void)copyAllFieldsTo:(OrgJodaTimeTzDateTimeZoneBuilder *)other {
  [super copyAllFieldsTo:other];
  other->iRuleSets_ = iRuleSets_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "readFromWithJavaIoInputStream:withNSString:", "readFrom", "Lorg.joda.time.DateTimeZone;", 0x9, "Ljava.io.IOException;" },
    { "readFromWithJavaIoDataInput:withNSString:", "readFrom", "Lorg.joda.time.DateTimeZone;", 0x9, "Ljava.io.IOException;" },
    { "writeMillisWithJavaIoDataOutput:withLong:", "writeMillis", "V", 0x8, "Ljava.io.IOException;" },
    { "readMillisWithJavaIoDataInput:", "readMillis", "J", 0x8, "Ljava.io.IOException;" },
    { "buildFixedZoneWithNSString:withNSString:withInt:withInt:", "buildFixedZone", "Lorg.joda.time.DateTimeZone;", 0xa, NULL },
    { "init", "DateTimeZoneBuilder", NULL, 0x1, NULL },
    { "addCutoverWithInt:withChar:withInt:withInt:withInt:withBoolean:withInt:", "addCutover", "Lorg.joda.time.tz.DateTimeZoneBuilder;", 0x1, NULL },
    { "setStandardOffsetWithInt:", "setStandardOffset", "Lorg.joda.time.tz.DateTimeZoneBuilder;", 0x1, NULL },
    { "setFixedSavingsWithNSString:withInt:", "setFixedSavings", "Lorg.joda.time.tz.DateTimeZoneBuilder;", 0x1, NULL },
    { "addRecurringSavingsWithNSString:withInt:withInt:withInt:withChar:withInt:withInt:withInt:withBoolean:withInt:", "addRecurringSavings", "Lorg.joda.time.tz.DateTimeZoneBuilder;", 0x1, NULL },
    { "getLastRuleSet", NULL, "Lorg.joda.time.tz.DateTimeZoneBuilder$RuleSet;", 0x2, NULL },
    { "toDateTimeZoneWithNSString:withBoolean:", "toDateTimeZone", "Lorg.joda.time.DateTimeZone;", 0x1, NULL },
    { "addTransitionWithJavaUtilArrayList:withOrgJodaTimeTzDateTimeZoneBuilder_Transition:", "addTransition", "Z", 0x2, NULL },
    { "writeToWithNSString:withJavaIoOutputStream:", "writeTo", "V", 0x1, "Ljava.io.IOException;" },
    { "writeToWithNSString:withJavaIoDataOutput:", "writeTo", "V", 0x1, "Ljava.io.IOException;" },
  };
  static J2ObjcFieldInfo fields[] = {
    { "iRuleSets_", NULL, 0x12, "Ljava.util.ArrayList;", NULL,  },
  };
  static J2ObjcClassInfo _OrgJodaTimeTzDateTimeZoneBuilder = { "DateTimeZoneBuilder", "org.joda.time.tz", NULL, 0x1, 15, methods, 1, fields, 0, NULL};
  return &_OrgJodaTimeTzDateTimeZoneBuilder;
}

@end

@implementation OrgJodaTimeTzDateTimeZoneBuilder_OfYear

+ (OrgJodaTimeTzDateTimeZoneBuilder_OfYear *)readFromWithJavaIoDataInput:(id<JavaIoDataInput>)inArg {
  return [[OrgJodaTimeTzDateTimeZoneBuilder_OfYear alloc] initWithChar:(unichar) [((id<JavaIoDataInput>) nil_chk(inArg)) readUnsignedByte] withInt:(int) [inArg readUnsignedByte] withInt:(int) [inArg readByte] withInt:(int) [inArg readUnsignedByte] withBoolean:[inArg readBoolean] withInt:(int) [OrgJodaTimeTzDateTimeZoneBuilder readMillisWithJavaIoDataInput:inArg]];
}

- (instancetype)initWithChar:(unichar)mode
                     withInt:(int)monthOfYear
                     withInt:(int)dayOfMonth
                     withInt:(int)dayOfWeek
                 withBoolean:(BOOL)advanceDayOfWeek
                     withInt:(int)millisOfDay {
  if (self = [super init]) {
    if (mode != 'u' && mode != 'w' && mode != 's') {
      @throw [[JavaLangIllegalArgumentException alloc] initWithNSString:[NSString stringWithFormat:@"Unknown mode: %C", mode]];
    }
    iMode_ = mode;
    iMonthOfYear_ = monthOfYear;
    iDayOfMonth_ = dayOfMonth;
    iDayOfWeek_ = dayOfWeek;
    iAdvance_ = advanceDayOfWeek;
    iMillisOfDay_ = millisOfDay;
  }
  return self;
}

- (long long int)setInstantWithInt:(int)year
                           withInt:(int)standardOffset
                           withInt:(int)saveMillis {
  int offset;
  if (iMode_ == 'w') {
    offset = standardOffset + saveMillis;
  }
  else if (iMode_ == 's') {
    offset = standardOffset;
  }
  else {
    offset = 0;
  }
  OrgJodaTimeChronology *chrono = [OrgJodaTimeChronoISOChronology getInstanceUTC];
  long long int millis = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) year])) setWithLong:0 withInt:year];
  millis = [((OrgJodaTimeDateTimeField *) nil_chk([chrono monthOfYear])) setWithLong:millis withInt:iMonthOfYear_];
  millis = [((OrgJodaTimeDateTimeField *) nil_chk([chrono millisOfDay])) setWithLong:millis withInt:iMillisOfDay_];
  millis = [self setDayOfMonthWithOrgJodaTimeChronology:chrono withLong:millis];
  if (iDayOfWeek_ != 0) {
    millis = [self setDayOfWeekWithOrgJodaTimeChronology:chrono withLong:millis];
  }
  return millis - offset;
}

- (long long int)nextWithLong:(long long int)instant
                      withInt:(int)standardOffset
                      withInt:(int)saveMillis {
  int offset;
  if (iMode_ == 'w') {
    offset = standardOffset + saveMillis;
  }
  else if (iMode_ == 's') {
    offset = standardOffset;
  }
  else {
    offset = 0;
  }
  instant += offset;
  OrgJodaTimeChronology *chrono = [OrgJodaTimeChronoISOChronology getInstanceUTC];
  long long int next = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) monthOfYear])) setWithLong:instant withInt:iMonthOfYear_];
  next = [((OrgJodaTimeDateTimeField *) nil_chk([chrono millisOfDay])) setWithLong:next withInt:0];
  next = [((OrgJodaTimeDateTimeField *) nil_chk([chrono millisOfDay])) addWithLong:next withInt:iMillisOfDay_];
  next = [self setDayOfMonthNextWithOrgJodaTimeChronology:chrono withLong:next];
  if (iDayOfWeek_ == 0) {
    if (next <= instant) {
      next = [((OrgJodaTimeDateTimeField *) nil_chk([chrono year])) addWithLong:next withInt:1];
      next = [self setDayOfMonthNextWithOrgJodaTimeChronology:chrono withLong:next];
    }
  }
  else {
    next = [self setDayOfWeekWithOrgJodaTimeChronology:chrono withLong:next];
    if (next <= instant) {
      next = [((OrgJodaTimeDateTimeField *) nil_chk([chrono year])) addWithLong:next withInt:1];
      next = [((OrgJodaTimeDateTimeField *) nil_chk([chrono monthOfYear])) setWithLong:next withInt:iMonthOfYear_];
      next = [self setDayOfMonthNextWithOrgJodaTimeChronology:chrono withLong:next];
      next = [self setDayOfWeekWithOrgJodaTimeChronology:chrono withLong:next];
    }
  }
  return next - offset;
}

- (long long int)previousWithLong:(long long int)instant
                          withInt:(int)standardOffset
                          withInt:(int)saveMillis {
  int offset;
  if (iMode_ == 'w') {
    offset = standardOffset + saveMillis;
  }
  else if (iMode_ == 's') {
    offset = standardOffset;
  }
  else {
    offset = 0;
  }
  instant += offset;
  OrgJodaTimeChronology *chrono = [OrgJodaTimeChronoISOChronology getInstanceUTC];
  long long int prev = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) monthOfYear])) setWithLong:instant withInt:iMonthOfYear_];
  prev = [((OrgJodaTimeDateTimeField *) nil_chk([chrono millisOfDay])) setWithLong:prev withInt:0];
  prev = [((OrgJodaTimeDateTimeField *) nil_chk([chrono millisOfDay])) addWithLong:prev withInt:iMillisOfDay_];
  prev = [self setDayOfMonthPreviousWithOrgJodaTimeChronology:chrono withLong:prev];
  if (iDayOfWeek_ == 0) {
    if (prev >= instant) {
      prev = [((OrgJodaTimeDateTimeField *) nil_chk([chrono year])) addWithLong:prev withInt:-1];
      prev = [self setDayOfMonthPreviousWithOrgJodaTimeChronology:chrono withLong:prev];
    }
  }
  else {
    prev = [self setDayOfWeekWithOrgJodaTimeChronology:chrono withLong:prev];
    if (prev >= instant) {
      prev = [((OrgJodaTimeDateTimeField *) nil_chk([chrono year])) addWithLong:prev withInt:-1];
      prev = [((OrgJodaTimeDateTimeField *) nil_chk([chrono monthOfYear])) setWithLong:prev withInt:iMonthOfYear_];
      prev = [self setDayOfMonthPreviousWithOrgJodaTimeChronology:chrono withLong:prev];
      prev = [self setDayOfWeekWithOrgJodaTimeChronology:chrono withLong:prev];
    }
  }
  return prev - offset;
}

- (BOOL)isEqual:(id)obj {
  if (self == obj) {
    return YES;
  }
  if ([obj isKindOfClass:[OrgJodaTimeTzDateTimeZoneBuilder_OfYear class]]) {
    OrgJodaTimeTzDateTimeZoneBuilder_OfYear *other = (OrgJodaTimeTzDateTimeZoneBuilder_OfYear *) check_class_cast(obj, [OrgJodaTimeTzDateTimeZoneBuilder_OfYear class]);
    return iMode_ == ((OrgJodaTimeTzDateTimeZoneBuilder_OfYear *) nil_chk(other))->iMode_ && iMonthOfYear_ == other->iMonthOfYear_ && iDayOfMonth_ == other->iDayOfMonth_ && iDayOfWeek_ == other->iDayOfWeek_ && iAdvance_ == other->iAdvance_ && iMillisOfDay_ == other->iMillisOfDay_;
  }
  return NO;
}

- (void)writeToWithJavaIoDataOutput:(id<JavaIoDataOutput>)outArg {
  [((id<JavaIoDataOutput>) nil_chk(outArg)) writeByteWithInt:iMode_];
  [outArg writeByteWithInt:iMonthOfYear_];
  [outArg writeByteWithInt:iDayOfMonth_];
  [outArg writeByteWithInt:iDayOfWeek_];
  [outArg writeBooleanWithBoolean:iAdvance_];
  [OrgJodaTimeTzDateTimeZoneBuilder writeMillisWithJavaIoDataOutput:outArg withLong:iMillisOfDay_];
}

- (long long int)setDayOfMonthNextWithOrgJodaTimeChronology:(OrgJodaTimeChronology *)chrono
                                                   withLong:(long long int)next {
  @try {
    next = [self setDayOfMonthWithOrgJodaTimeChronology:chrono withLong:next];
  }
  @catch (JavaLangIllegalArgumentException *e) {
    if (iMonthOfYear_ == 2 && iDayOfMonth_ == 29) {
      while ([((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) year])) isLeapWithLong:next] == NO) {
        next = [((OrgJodaTimeDateTimeField *) nil_chk([chrono year])) addWithLong:next withInt:1];
      }
      next = [self setDayOfMonthWithOrgJodaTimeChronology:chrono withLong:next];
    }
    else {
      @throw e;
    }
  }
  return next;
}

- (long long int)setDayOfMonthPreviousWithOrgJodaTimeChronology:(OrgJodaTimeChronology *)chrono
                                                       withLong:(long long int)prev {
  @try {
    prev = [self setDayOfMonthWithOrgJodaTimeChronology:chrono withLong:prev];
  }
  @catch (JavaLangIllegalArgumentException *e) {
    if (iMonthOfYear_ == 2 && iDayOfMonth_ == 29) {
      while ([((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) year])) isLeapWithLong:prev] == NO) {
        prev = [((OrgJodaTimeDateTimeField *) nil_chk([chrono year])) addWithLong:prev withInt:-1];
      }
      prev = [self setDayOfMonthWithOrgJodaTimeChronology:chrono withLong:prev];
    }
    else {
      @throw e;
    }
  }
  return prev;
}

- (long long int)setDayOfMonthWithOrgJodaTimeChronology:(OrgJodaTimeChronology *)chrono
                                               withLong:(long long int)instant {
  if (iDayOfMonth_ >= 0) {
    instant = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) dayOfMonth])) setWithLong:instant withInt:iDayOfMonth_];
  }
  else {
    instant = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) dayOfMonth])) setWithLong:instant withInt:1];
    instant = [((OrgJodaTimeDateTimeField *) nil_chk([chrono monthOfYear])) addWithLong:instant withInt:1];
    instant = [((OrgJodaTimeDateTimeField *) nil_chk([chrono dayOfMonth])) addWithLong:instant withInt:iDayOfMonth_];
  }
  return instant;
}

- (long long int)setDayOfWeekWithOrgJodaTimeChronology:(OrgJodaTimeChronology *)chrono
                                              withLong:(long long int)instant {
  int dayOfWeek = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) dayOfWeek])) getWithLong:instant];
  int daysToAdd = iDayOfWeek_ - dayOfWeek;
  if (daysToAdd != 0) {
    if (iAdvance_) {
      if (daysToAdd < 0) {
        daysToAdd += 7;
      }
    }
    else {
      if (daysToAdd > 0) {
        daysToAdd -= 7;
      }
    }
    instant = [((OrgJodaTimeDateTimeField *) nil_chk([chrono dayOfWeek])) addWithLong:instant withInt:daysToAdd];
  }
  return instant;
}

- (void)copyAllFieldsTo:(OrgJodaTimeTzDateTimeZoneBuilder_OfYear *)other {
  [super copyAllFieldsTo:other];
  other->iAdvance_ = iAdvance_;
  other->iDayOfMonth_ = iDayOfMonth_;
  other->iDayOfWeek_ = iDayOfWeek_;
  other->iMillisOfDay_ = iMillisOfDay_;
  other->iMode_ = iMode_;
  other->iMonthOfYear_ = iMonthOfYear_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "readFromWithJavaIoDataInput:", "readFrom", "Lorg.joda.time.tz.DateTimeZoneBuilder$OfYear;", 0x8, "Ljava.io.IOException;" },
    { "initWithChar:withInt:withInt:withInt:withBoolean:withInt:", "OfYear", NULL, 0x0, NULL },
    { "setInstantWithInt:withInt:withInt:", "setInstant", "J", 0x1, NULL },
    { "nextWithLong:withInt:withInt:", "next", "J", 0x1, NULL },
    { "previousWithLong:withInt:withInt:", "previous", "J", 0x1, NULL },
    { "isEqual:", "equals", "Z", 0x1, NULL },
    { "writeToWithJavaIoDataOutput:", "writeTo", "V", 0x1, "Ljava.io.IOException;" },
    { "setDayOfMonthNextWithOrgJodaTimeChronology:withLong:", "setDayOfMonthNext", "J", 0x2, NULL },
    { "setDayOfMonthPreviousWithOrgJodaTimeChronology:withLong:", "setDayOfMonthPrevious", "J", 0x2, NULL },
    { "setDayOfMonthWithOrgJodaTimeChronology:withLong:", "setDayOfMonth", "J", 0x2, NULL },
    { "setDayOfWeekWithOrgJodaTimeChronology:withLong:", "setDayOfWeek", "J", 0x2, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "iMode_", NULL, 0x10, "C", NULL,  },
    { "iMonthOfYear_", NULL, 0x10, "I", NULL,  },
    { "iDayOfMonth_", NULL, 0x10, "I", NULL,  },
    { "iDayOfWeek_", NULL, 0x10, "I", NULL,  },
    { "iAdvance_", NULL, 0x10, "Z", NULL,  },
    { "iMillisOfDay_", NULL, 0x10, "I", NULL,  },
  };
  static J2ObjcClassInfo _OrgJodaTimeTzDateTimeZoneBuilder_OfYear = { "OfYear", "org.joda.time.tz", "DateTimeZoneBuilder", 0x1a, 11, methods, 6, fields, 0, NULL};
  return &_OrgJodaTimeTzDateTimeZoneBuilder_OfYear;
}

@end

@implementation OrgJodaTimeTzDateTimeZoneBuilder_Recurrence

+ (OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *)readFromWithJavaIoDataInput:(id<JavaIoDataInput>)inArg {
  return [[OrgJodaTimeTzDateTimeZoneBuilder_Recurrence alloc] initWithOrgJodaTimeTzDateTimeZoneBuilder_OfYear:[OrgJodaTimeTzDateTimeZoneBuilder_OfYear readFromWithJavaIoDataInput:inArg] withNSString:[((id<JavaIoDataInput>) nil_chk(inArg)) readUTF] withInt:(int) [OrgJodaTimeTzDateTimeZoneBuilder readMillisWithJavaIoDataInput:inArg]];
}

- (instancetype)initWithOrgJodaTimeTzDateTimeZoneBuilder_OfYear:(OrgJodaTimeTzDateTimeZoneBuilder_OfYear *)ofYear
                                                   withNSString:(NSString *)nameKey
                                                        withInt:(int)saveMillis {
  if (self = [super init]) {
    iOfYear_ = ofYear;
    iNameKey_ = nameKey;
    iSaveMillis_ = saveMillis;
  }
  return self;
}

- (OrgJodaTimeTzDateTimeZoneBuilder_OfYear *)getOfYear {
  return iOfYear_;
}

- (long long int)nextWithLong:(long long int)instant
                      withInt:(int)standardOffset
                      withInt:(int)saveMillis {
  return [((OrgJodaTimeTzDateTimeZoneBuilder_OfYear *) nil_chk(iOfYear_)) nextWithLong:instant withInt:standardOffset withInt:saveMillis];
}

- (long long int)previousWithLong:(long long int)instant
                          withInt:(int)standardOffset
                          withInt:(int)saveMillis {
  return [((OrgJodaTimeTzDateTimeZoneBuilder_OfYear *) nil_chk(iOfYear_)) previousWithLong:instant withInt:standardOffset withInt:saveMillis];
}

- (NSString *)getNameKey {
  return iNameKey_;
}

- (int)getSaveMillis {
  return iSaveMillis_;
}

- (BOOL)isEqual:(id)obj {
  if (self == obj) {
    return YES;
  }
  if ([obj isKindOfClass:[OrgJodaTimeTzDateTimeZoneBuilder_Recurrence class]]) {
    OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *other = (OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) check_class_cast(obj, [OrgJodaTimeTzDateTimeZoneBuilder_Recurrence class]);
    return iSaveMillis_ == ((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(other))->iSaveMillis_ && [((NSString *) nil_chk(iNameKey_)) isEqual:other->iNameKey_] && [((OrgJodaTimeTzDateTimeZoneBuilder_OfYear *) nil_chk(iOfYear_)) isEqual:other->iOfYear_];
  }
  return NO;
}

- (void)writeToWithJavaIoDataOutput:(id<JavaIoDataOutput>)outArg {
  [((OrgJodaTimeTzDateTimeZoneBuilder_OfYear *) nil_chk(iOfYear_)) writeToWithJavaIoDataOutput:outArg];
  [((id<JavaIoDataOutput>) nil_chk(outArg)) writeUTFWithNSString:iNameKey_];
  [OrgJodaTimeTzDateTimeZoneBuilder writeMillisWithJavaIoDataOutput:outArg withLong:iSaveMillis_];
}

- (OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *)renameWithNSString:(NSString *)nameKey {
  return [[OrgJodaTimeTzDateTimeZoneBuilder_Recurrence alloc] initWithOrgJodaTimeTzDateTimeZoneBuilder_OfYear:iOfYear_ withNSString:nameKey withInt:iSaveMillis_];
}

- (OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *)renameAppendWithNSString:(NSString *)appendNameKey {
  return [self renameWithNSString:[([NSString stringWithFormat:@"%@%@", iNameKey_, appendNameKey]) intern]];
}

- (void)copyAllFieldsTo:(OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *)other {
  [super copyAllFieldsTo:other];
  other->iNameKey_ = iNameKey_;
  other->iOfYear_ = iOfYear_;
  other->iSaveMillis_ = iSaveMillis_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "readFromWithJavaIoDataInput:", "readFrom", "Lorg.joda.time.tz.DateTimeZoneBuilder$Recurrence;", 0x8, "Ljava.io.IOException;" },
    { "initWithOrgJodaTimeTzDateTimeZoneBuilder_OfYear:withNSString:withInt:", "Recurrence", NULL, 0x0, NULL },
    { "getOfYear", NULL, "Lorg.joda.time.tz.DateTimeZoneBuilder$OfYear;", 0x1, NULL },
    { "nextWithLong:withInt:withInt:", "next", "J", 0x1, NULL },
    { "previousWithLong:withInt:withInt:", "previous", "J", 0x1, NULL },
    { "getNameKey", NULL, "Ljava.lang.String;", 0x1, NULL },
    { "getSaveMillis", NULL, "I", 0x1, NULL },
    { "isEqual:", "equals", "Z", 0x1, NULL },
    { "writeToWithJavaIoDataOutput:", "writeTo", "V", 0x1, "Ljava.io.IOException;" },
    { "renameWithNSString:", "rename", "Lorg.joda.time.tz.DateTimeZoneBuilder$Recurrence;", 0x0, NULL },
    { "renameAppendWithNSString:", "renameAppend", "Lorg.joda.time.tz.DateTimeZoneBuilder$Recurrence;", 0x0, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "iOfYear_", NULL, 0x10, "Lorg.joda.time.tz.DateTimeZoneBuilder$OfYear;", NULL,  },
    { "iNameKey_", NULL, 0x10, "Ljava.lang.String;", NULL,  },
    { "iSaveMillis_", NULL, 0x10, "I", NULL,  },
  };
  static J2ObjcClassInfo _OrgJodaTimeTzDateTimeZoneBuilder_Recurrence = { "Recurrence", "org.joda.time.tz", "DateTimeZoneBuilder", 0x1a, 11, methods, 3, fields, 0, NULL};
  return &_OrgJodaTimeTzDateTimeZoneBuilder_Recurrence;
}

@end

@implementation OrgJodaTimeTzDateTimeZoneBuilder_Rule

- (instancetype)initWithOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:(OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *)recurrence
                                                            withInt:(int)fromYear
                                                            withInt:(int)toYear {
  if (self = [super init]) {
    iRecurrence_ = recurrence;
    iFromYear_ = fromYear;
    iToYear_ = toYear;
  }
  return self;
}

- (int)getFromYear {
  return iFromYear_;
}

- (int)getToYear {
  return iToYear_;
}

- (OrgJodaTimeTzDateTimeZoneBuilder_OfYear *)getOfYear {
  return [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(iRecurrence_)) getOfYear];
}

- (NSString *)getNameKey {
  return [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(iRecurrence_)) getNameKey];
}

- (int)getSaveMillis {
  return [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(iRecurrence_)) getSaveMillis];
}

- (long long int)nextWithLong:(long long int)instant
                      withInt:(int)standardOffset
                      withInt:(int)saveMillis {
  OrgJodaTimeChronology *chrono = [OrgJodaTimeChronoISOChronology getInstanceUTC];
  int wallOffset = standardOffset + saveMillis;
  long long int testInstant = instant;
  int year;
  if (instant == JavaLangLong_MIN_VALUE) {
    year = JavaLangInteger_MIN_VALUE;
  }
  else {
    year = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) year])) getWithLong:instant + wallOffset];
  }
  if (year < iFromYear_) {
    testInstant = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) year])) setWithLong:0 withInt:iFromYear_] - wallOffset;
    testInstant -= 1;
  }
  long long int next = [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(iRecurrence_)) nextWithLong:testInstant withInt:standardOffset withInt:saveMillis];
  if (next > instant) {
    year = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) year])) getWithLong:next + wallOffset];
    if (year > iToYear_) {
      next = instant;
    }
  }
  return next;
}

- (void)copyAllFieldsTo:(OrgJodaTimeTzDateTimeZoneBuilder_Rule *)other {
  [super copyAllFieldsTo:other];
  other->iFromYear_ = iFromYear_;
  other->iRecurrence_ = iRecurrence_;
  other->iToYear_ = iToYear_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "initWithOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:withInt:withInt:", "Rule", NULL, 0x0, NULL },
    { "getFromYear", NULL, "I", 0x1, NULL },
    { "getToYear", NULL, "I", 0x1, NULL },
    { "getOfYear", NULL, "Lorg.joda.time.tz.DateTimeZoneBuilder$OfYear;", 0x1, NULL },
    { "getNameKey", NULL, "Ljava.lang.String;", 0x1, NULL },
    { "getSaveMillis", NULL, "I", 0x1, NULL },
    { "nextWithLong:withInt:withInt:", "next", "J", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "iRecurrence_", NULL, 0x10, "Lorg.joda.time.tz.DateTimeZoneBuilder$Recurrence;", NULL,  },
    { "iFromYear_", NULL, 0x10, "I", NULL,  },
    { "iToYear_", NULL, 0x10, "I", NULL,  },
  };
  static J2ObjcClassInfo _OrgJodaTimeTzDateTimeZoneBuilder_Rule = { "Rule", "org.joda.time.tz", "DateTimeZoneBuilder", 0x1a, 7, methods, 3, fields, 0, NULL};
  return &_OrgJodaTimeTzDateTimeZoneBuilder_Rule;
}

@end

@implementation OrgJodaTimeTzDateTimeZoneBuilder_Transition

- (instancetype)initWithLong:(long long int)millis
withOrgJodaTimeTzDateTimeZoneBuilder_Transition:(OrgJodaTimeTzDateTimeZoneBuilder_Transition *)tr {
  if (self = [super init]) {
    iMillis_ = millis;
    iNameKey_ = ((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(tr))->iNameKey_;
    iWallOffset_ = tr->iWallOffset_;
    iStandardOffset_ = tr->iStandardOffset_;
  }
  return self;
}

- (instancetype)initWithLong:(long long int)millis
withOrgJodaTimeTzDateTimeZoneBuilder_Rule:(OrgJodaTimeTzDateTimeZoneBuilder_Rule *)rule
                     withInt:(int)standardOffset {
  if (self = [super init]) {
    iMillis_ = millis;
    iNameKey_ = [((OrgJodaTimeTzDateTimeZoneBuilder_Rule *) nil_chk(rule)) getNameKey];
    iWallOffset_ = standardOffset + [rule getSaveMillis];
    iStandardOffset_ = standardOffset;
  }
  return self;
}

- (instancetype)initWithLong:(long long int)millis
                withNSString:(NSString *)nameKey
                     withInt:(int)wallOffset
                     withInt:(int)standardOffset {
  if (self = [super init]) {
    iMillis_ = millis;
    iNameKey_ = nameKey;
    iWallOffset_ = wallOffset;
    iStandardOffset_ = standardOffset;
  }
  return self;
}

- (long long int)getMillis {
  return iMillis_;
}

- (NSString *)getNameKey {
  return iNameKey_;
}

- (int)getWallOffset {
  return iWallOffset_;
}

- (int)getStandardOffset {
  return iStandardOffset_;
}

- (int)getSaveMillis {
  return iWallOffset_ - iStandardOffset_;
}

- (BOOL)isTransitionFromWithOrgJodaTimeTzDateTimeZoneBuilder_Transition:(OrgJodaTimeTzDateTimeZoneBuilder_Transition *)other {
  if (other == nil) {
    return YES;
  }
  return iMillis_ > ((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(other))->iMillis_ && (iWallOffset_ != other->iWallOffset_ || !([((NSString *) nil_chk(iNameKey_)) isEqual:other->iNameKey_]));
}

- (void)copyAllFieldsTo:(OrgJodaTimeTzDateTimeZoneBuilder_Transition *)other {
  [super copyAllFieldsTo:other];
  other->iMillis_ = iMillis_;
  other->iNameKey_ = iNameKey_;
  other->iStandardOffset_ = iStandardOffset_;
  other->iWallOffset_ = iWallOffset_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "initWithLong:withOrgJodaTimeTzDateTimeZoneBuilder_Transition:", "Transition", NULL, 0x0, NULL },
    { "initWithLong:withOrgJodaTimeTzDateTimeZoneBuilder_Rule:withInt:", "Transition", NULL, 0x0, NULL },
    { "initWithLong:withNSString:withInt:withInt:", "Transition", NULL, 0x0, NULL },
    { "getMillis", NULL, "J", 0x1, NULL },
    { "getNameKey", NULL, "Ljava.lang.String;", 0x1, NULL },
    { "getWallOffset", NULL, "I", 0x1, NULL },
    { "getStandardOffset", NULL, "I", 0x1, NULL },
    { "getSaveMillis", NULL, "I", 0x1, NULL },
    { "isTransitionFromWithOrgJodaTimeTzDateTimeZoneBuilder_Transition:", "isTransitionFrom", "Z", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "iMillis_", NULL, 0x12, "J", NULL,  },
    { "iNameKey_", NULL, 0x12, "Ljava.lang.String;", NULL,  },
    { "iWallOffset_", NULL, 0x12, "I", NULL,  },
    { "iStandardOffset_", NULL, 0x12, "I", NULL,  },
  };
  static J2ObjcClassInfo _OrgJodaTimeTzDateTimeZoneBuilder_Transition = { "Transition", "org.joda.time.tz", "DateTimeZoneBuilder", 0x1a, 9, methods, 4, fields, 0, NULL};
  return &_OrgJodaTimeTzDateTimeZoneBuilder_Transition;
}

@end

BOOL OrgJodaTimeTzDateTimeZoneBuilder_RuleSet_initialized = NO;

@implementation OrgJodaTimeTzDateTimeZoneBuilder_RuleSet

int OrgJodaTimeTzDateTimeZoneBuilder_RuleSet_YEAR_LIMIT_;

- (instancetype)init {
  if (self = [super init]) {
    iRules_ = [[JavaUtilArrayList alloc] initWithInt:10];
    iUpperYear_ = JavaLangInteger_MAX_VALUE;
  }
  return self;
}

- (instancetype)initWithOrgJodaTimeTzDateTimeZoneBuilder_RuleSet:(OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *)rs {
  if (self = [super init]) {
    iStandardOffset_ = ((OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *) nil_chk(rs))->iStandardOffset_;
    iRules_ = [[JavaUtilArrayList alloc] initWithJavaUtilCollection:rs->iRules_];
    iInitialNameKey_ = rs->iInitialNameKey_;
    iInitialSaveMillis_ = rs->iInitialSaveMillis_;
    iUpperYear_ = rs->iUpperYear_;
    iUpperOfYear_ = rs->iUpperOfYear_;
  }
  return self;
}

- (int)getStandardOffset {
  return iStandardOffset_;
}

- (void)setStandardOffsetWithInt:(int)standardOffset {
  iStandardOffset_ = standardOffset;
}

- (void)setFixedSavingsWithNSString:(NSString *)nameKey
                            withInt:(int)saveMillis {
  iInitialNameKey_ = nameKey;
  iInitialSaveMillis_ = saveMillis;
}

- (void)addRuleWithOrgJodaTimeTzDateTimeZoneBuilder_Rule:(OrgJodaTimeTzDateTimeZoneBuilder_Rule *)rule {
  if (![((JavaUtilArrayList *) nil_chk(iRules_)) containsWithId:rule]) {
    [iRules_ addWithId:rule];
  }
}

- (void)setUpperLimitWithInt:(int)year
withOrgJodaTimeTzDateTimeZoneBuilder_OfYear:(OrgJodaTimeTzDateTimeZoneBuilder_OfYear *)ofYear {
  iUpperYear_ = year;
  iUpperOfYear_ = ofYear;
}

- (OrgJodaTimeTzDateTimeZoneBuilder_Transition *)firstTransitionWithLong:(long long int)firstMillis {
  if (iInitialNameKey_ != nil) {
    return [[OrgJodaTimeTzDateTimeZoneBuilder_Transition alloc] initWithLong:firstMillis withNSString:iInitialNameKey_ withInt:iStandardOffset_ + iInitialSaveMillis_ withInt:iStandardOffset_];
  }
  JavaUtilArrayList *copy_ = [[JavaUtilArrayList alloc] initWithJavaUtilCollection:iRules_];
  long long int millis = JavaLangLong_MIN_VALUE;
  int saveMillis = 0;
  OrgJodaTimeTzDateTimeZoneBuilder_Transition *first = nil;
  OrgJodaTimeTzDateTimeZoneBuilder_Transition *next;
  while ((next = [self nextTransitionWithLong:millis withInt:saveMillis]) != nil) {
    millis = [((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(next)) getMillis];
    if (millis == firstMillis) {
      first = [[OrgJodaTimeTzDateTimeZoneBuilder_Transition alloc] initWithLong:firstMillis withOrgJodaTimeTzDateTimeZoneBuilder_Transition:next];
      break;
    }
    if (millis > firstMillis) {
      if (first == nil) {
        for (OrgJodaTimeTzDateTimeZoneBuilder_Rule * __strong rule in copy_) {
          if ([((OrgJodaTimeTzDateTimeZoneBuilder_Rule *) nil_chk(rule)) getSaveMillis] == 0) {
            first = [[OrgJodaTimeTzDateTimeZoneBuilder_Transition alloc] initWithLong:firstMillis withOrgJodaTimeTzDateTimeZoneBuilder_Rule:rule withInt:iStandardOffset_];
            break;
          }
        }
      }
      if (first == nil) {
        first = [[OrgJodaTimeTzDateTimeZoneBuilder_Transition alloc] initWithLong:firstMillis withNSString:[next getNameKey] withInt:iStandardOffset_ withInt:iStandardOffset_];
      }
      break;
    }
    first = [[OrgJodaTimeTzDateTimeZoneBuilder_Transition alloc] initWithLong:firstMillis withOrgJodaTimeTzDateTimeZoneBuilder_Transition:next];
    saveMillis = [next getSaveMillis];
  }
  iRules_ = copy_;
  return first;
}

- (OrgJodaTimeTzDateTimeZoneBuilder_Transition *)nextTransitionWithLong:(long long int)instant
                                                                withInt:(int)saveMillis {
  OrgJodaTimeChronology *chrono = [OrgJodaTimeChronoISOChronology getInstanceUTC];
  OrgJodaTimeTzDateTimeZoneBuilder_Rule *nextRule = nil;
  long long int nextMillis = JavaLangLong_MAX_VALUE;
  id<JavaUtilIterator> it = [((JavaUtilArrayList *) nil_chk(iRules_)) iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    OrgJodaTimeTzDateTimeZoneBuilder_Rule *rule = [it next];
    long long int next = [((OrgJodaTimeTzDateTimeZoneBuilder_Rule *) nil_chk(rule)) nextWithLong:instant withInt:iStandardOffset_ withInt:saveMillis];
    if (next <= instant) {
      [it remove];
      continue;
    }
    if (next <= nextMillis) {
      nextRule = rule;
      nextMillis = next;
    }
  }
  if (nextRule == nil) {
    return nil;
  }
  if ([((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronology *) nil_chk(chrono)) year])) getWithLong:nextMillis] >= OrgJodaTimeTzDateTimeZoneBuilder_RuleSet_YEAR_LIMIT_) {
    return nil;
  }
  if (iUpperYear_ < JavaLangInteger_MAX_VALUE) {
    long long int upperMillis = [((OrgJodaTimeTzDateTimeZoneBuilder_OfYear *) nil_chk(iUpperOfYear_)) setInstantWithInt:iUpperYear_ withInt:iStandardOffset_ withInt:saveMillis];
    if (nextMillis >= upperMillis) {
      return nil;
    }
  }
  return [[OrgJodaTimeTzDateTimeZoneBuilder_Transition alloc] initWithLong:nextMillis withOrgJodaTimeTzDateTimeZoneBuilder_Rule:nextRule withInt:iStandardOffset_];
}

- (long long int)getUpperLimitWithInt:(int)saveMillis {
  if (iUpperYear_ == JavaLangInteger_MAX_VALUE) {
    return JavaLangLong_MAX_VALUE;
  }
  return [((OrgJodaTimeTzDateTimeZoneBuilder_OfYear *) nil_chk(iUpperOfYear_)) setInstantWithInt:iUpperYear_ withInt:iStandardOffset_ withInt:saveMillis];
}

- (OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *)buildTailZoneWithNSString:(NSString *)id_ {
  if ([((JavaUtilArrayList *) nil_chk(iRules_)) size] == 2) {
    OrgJodaTimeTzDateTimeZoneBuilder_Rule *startRule = [iRules_ getWithInt:0];
    OrgJodaTimeTzDateTimeZoneBuilder_Rule *endRule = [iRules_ getWithInt:1];
    if ([((OrgJodaTimeTzDateTimeZoneBuilder_Rule *) nil_chk(startRule)) getToYear] == JavaLangInteger_MAX_VALUE && [((OrgJodaTimeTzDateTimeZoneBuilder_Rule *) nil_chk(endRule)) getToYear] == JavaLangInteger_MAX_VALUE) {
      return [[OrgJodaTimeTzDateTimeZoneBuilder_DSTZone alloc] initWithNSString:id_ withInt:iStandardOffset_ withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:startRule->iRecurrence_ withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:endRule->iRecurrence_];
    }
  }
  return nil;
}

+ (void)initialize {
  if (self == [OrgJodaTimeTzDateTimeZoneBuilder_RuleSet class]) {
    {
      long long int now = [OrgJodaTimeDateTimeUtils currentTimeMillis];
      OrgJodaTimeTzDateTimeZoneBuilder_RuleSet_YEAR_LIMIT_ = [((OrgJodaTimeDateTimeField *) nil_chk([((OrgJodaTimeChronoISOChronology *) nil_chk([OrgJodaTimeChronoISOChronology getInstanceUTC])) year])) getWithLong:now] + 100;
    }
    OrgJodaTimeTzDateTimeZoneBuilder_RuleSet_initialized = YES;
  }
}

- (void)copyAllFieldsTo:(OrgJodaTimeTzDateTimeZoneBuilder_RuleSet *)other {
  [super copyAllFieldsTo:other];
  other->iInitialNameKey_ = iInitialNameKey_;
  other->iInitialSaveMillis_ = iInitialSaveMillis_;
  other->iRules_ = iRules_;
  other->iStandardOffset_ = iStandardOffset_;
  other->iUpperOfYear_ = iUpperOfYear_;
  other->iUpperYear_ = iUpperYear_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "init", "RuleSet", NULL, 0x0, NULL },
    { "initWithOrgJodaTimeTzDateTimeZoneBuilder_RuleSet:", "RuleSet", NULL, 0x0, NULL },
    { "getStandardOffset", NULL, "I", 0x1, NULL },
    { "setStandardOffsetWithInt:", "setStandardOffset", "V", 0x1, NULL },
    { "setFixedSavingsWithNSString:withInt:", "setFixedSavings", "V", 0x1, NULL },
    { "addRuleWithOrgJodaTimeTzDateTimeZoneBuilder_Rule:", "addRule", "V", 0x1, NULL },
    { "setUpperLimitWithInt:withOrgJodaTimeTzDateTimeZoneBuilder_OfYear:", "setUpperLimit", "V", 0x1, NULL },
    { "firstTransitionWithLong:", "firstTransition", "Lorg.joda.time.tz.DateTimeZoneBuilder$Transition;", 0x1, NULL },
    { "nextTransitionWithLong:withInt:", "nextTransition", "Lorg.joda.time.tz.DateTimeZoneBuilder$Transition;", 0x1, NULL },
    { "getUpperLimitWithInt:", "getUpperLimit", "J", 0x1, NULL },
    { "buildTailZoneWithNSString:", "buildTailZone", "Lorg.joda.time.tz.DateTimeZoneBuilder$DSTZone;", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "YEAR_LIMIT_", NULL, 0x1a, "I", &OrgJodaTimeTzDateTimeZoneBuilder_RuleSet_YEAR_LIMIT_,  },
    { "iStandardOffset_", NULL, 0x2, "I", NULL,  },
    { "iRules_", NULL, 0x2, "Ljava.util.ArrayList;", NULL,  },
    { "iInitialNameKey_", NULL, 0x2, "Ljava.lang.String;", NULL,  },
    { "iInitialSaveMillis_", NULL, 0x2, "I", NULL,  },
    { "iUpperYear_", NULL, 0x2, "I", NULL,  },
    { "iUpperOfYear_", NULL, 0x2, "Lorg.joda.time.tz.DateTimeZoneBuilder$OfYear;", NULL,  },
  };
  static J2ObjcClassInfo _OrgJodaTimeTzDateTimeZoneBuilder_RuleSet = { "RuleSet", "org.joda.time.tz", "DateTimeZoneBuilder", 0x1a, 11, methods, 7, fields, 0, NULL};
  return &_OrgJodaTimeTzDateTimeZoneBuilder_RuleSet;
}

@end

@implementation OrgJodaTimeTzDateTimeZoneBuilder_DSTZone

+ (OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *)readFromWithJavaIoDataInput:(id<JavaIoDataInput>)inArg
                                                             withNSString:(NSString *)id_ {
  return [[OrgJodaTimeTzDateTimeZoneBuilder_DSTZone alloc] initWithNSString:id_ withInt:(int) [OrgJodaTimeTzDateTimeZoneBuilder readMillisWithJavaIoDataInput:inArg] withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:[OrgJodaTimeTzDateTimeZoneBuilder_Recurrence readFromWithJavaIoDataInput:inArg] withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:[OrgJodaTimeTzDateTimeZoneBuilder_Recurrence readFromWithJavaIoDataInput:inArg]];
}

- (instancetype)initWithNSString:(NSString *)id_
                         withInt:(int)standardOffset
withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:(OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *)startRecurrence
withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:(OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *)endRecurrence {
  if (self = [super initWithNSString:id_]) {
    iStandardOffset_ = standardOffset;
    iStartRecurrence_ = startRecurrence;
    iEndRecurrence_ = endRecurrence;
  }
  return self;
}

- (NSString *)getNameKeyWithLong:(long long int)instant {
  return [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk([self findMatchingRecurrenceWithLong:instant])) getNameKey];
}

- (int)getOffsetWithLong:(long long int)instant {
  return iStandardOffset_ + [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk([self findMatchingRecurrenceWithLong:instant])) getSaveMillis];
}

- (int)getStandardOffsetWithLong:(long long int)instant {
  return iStandardOffset_;
}

- (BOOL)isFixed {
  return NO;
}

- (long long int)nextTransitionWithLong:(long long int)instant {
  int standardOffset = iStandardOffset_;
  OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *startRecurrence = iStartRecurrence_;
  OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *endRecurrence = iEndRecurrence_;
  long long int start, end;
  @try {
    start = [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(startRecurrence)) nextWithLong:instant withInt:standardOffset withInt:[((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(endRecurrence)) getSaveMillis]];
    if (instant > 0 && start < 0) {
      start = instant;
    }
  }
  @catch (JavaLangIllegalArgumentException *e) {
    start = instant;
  }
  @catch (JavaLangArithmeticException *e) {
    start = instant;
  }
  @try {
    end = [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(endRecurrence)) nextWithLong:instant withInt:standardOffset withInt:[((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(startRecurrence)) getSaveMillis]];
    if (instant > 0 && end < 0) {
      end = instant;
    }
  }
  @catch (JavaLangIllegalArgumentException *e) {
    end = instant;
  }
  @catch (JavaLangArithmeticException *e) {
    end = instant;
  }
  return (start > end) ? end : start;
}

- (long long int)previousTransitionWithLong:(long long int)instant {
  instant++;
  int standardOffset = iStandardOffset_;
  OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *startRecurrence = iStartRecurrence_;
  OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *endRecurrence = iEndRecurrence_;
  long long int start, end;
  @try {
    start = [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(startRecurrence)) previousWithLong:instant withInt:standardOffset withInt:[((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(endRecurrence)) getSaveMillis]];
    if (instant < 0 && start > 0) {
      start = instant;
    }
  }
  @catch (JavaLangIllegalArgumentException *e) {
    start = instant;
  }
  @catch (JavaLangArithmeticException *e) {
    start = instant;
  }
  @try {
    end = [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(endRecurrence)) previousWithLong:instant withInt:standardOffset withInt:[((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(startRecurrence)) getSaveMillis]];
    if (instant < 0 && end > 0) {
      end = instant;
    }
  }
  @catch (JavaLangIllegalArgumentException *e) {
    end = instant;
  }
  @catch (JavaLangArithmeticException *e) {
    end = instant;
  }
  return ((start > end) ? start : end) - 1;
}

- (BOOL)isEqual:(id)obj {
  if (self == obj) {
    return YES;
  }
  if ([obj isKindOfClass:[OrgJodaTimeTzDateTimeZoneBuilder_DSTZone class]]) {
    OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *other = (OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *) check_class_cast(obj, [OrgJodaTimeTzDateTimeZoneBuilder_DSTZone class]);
    return [((NSString *) nil_chk([self getID])) isEqual:[((OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *) nil_chk(other)) getID]] && iStandardOffset_ == other->iStandardOffset_ && [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(iStartRecurrence_)) isEqual:other->iStartRecurrence_] && [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(iEndRecurrence_)) isEqual:other->iEndRecurrence_];
  }
  return NO;
}

- (void)writeToWithJavaIoDataOutput:(id<JavaIoDataOutput>)outArg {
  [OrgJodaTimeTzDateTimeZoneBuilder writeMillisWithJavaIoDataOutput:outArg withLong:iStandardOffset_];
  [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(iStartRecurrence_)) writeToWithJavaIoDataOutput:outArg];
  [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(iEndRecurrence_)) writeToWithJavaIoDataOutput:outArg];
}

- (OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *)findMatchingRecurrenceWithLong:(long long int)instant {
  int standardOffset = iStandardOffset_;
  OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *startRecurrence = iStartRecurrence_;
  OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *endRecurrence = iEndRecurrence_;
  long long int start, end;
  @try {
    start = [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(startRecurrence)) nextWithLong:instant withInt:standardOffset withInt:[((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(endRecurrence)) getSaveMillis]];
  }
  @catch (JavaLangIllegalArgumentException *e) {
    start = instant;
  }
  @catch (JavaLangArithmeticException *e) {
    start = instant;
  }
  @try {
    end = [((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(endRecurrence)) nextWithLong:instant withInt:standardOffset withInt:[((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(startRecurrence)) getSaveMillis]];
  }
  @catch (JavaLangIllegalArgumentException *e) {
    end = instant;
  }
  @catch (JavaLangArithmeticException *e) {
    end = instant;
  }
  return (start > end) ? startRecurrence : endRecurrence;
}

- (void)copyAllFieldsTo:(OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *)other {
  [super copyAllFieldsTo:other];
  other->iEndRecurrence_ = iEndRecurrence_;
  other->iStandardOffset_ = iStandardOffset_;
  other->iStartRecurrence_ = iStartRecurrence_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "readFromWithJavaIoDataInput:withNSString:", "readFrom", "Lorg.joda.time.tz.DateTimeZoneBuilder$DSTZone;", 0x8, "Ljava.io.IOException;" },
    { "initWithNSString:withInt:withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:", "DSTZone", NULL, 0x0, NULL },
    { "getNameKeyWithLong:", "getNameKey", "Ljava.lang.String;", 0x1, NULL },
    { "getOffsetWithLong:", "getOffset", "I", 0x1, NULL },
    { "getStandardOffsetWithLong:", "getStandardOffset", "I", 0x1, NULL },
    { "isFixed", NULL, "Z", 0x1, NULL },
    { "nextTransitionWithLong:", "nextTransition", "J", 0x1, NULL },
    { "previousTransitionWithLong:", "previousTransition", "J", 0x1, NULL },
    { "isEqual:", "equals", "Z", 0x1, NULL },
    { "writeToWithJavaIoDataOutput:", "writeTo", "V", 0x1, "Ljava.io.IOException;" },
    { "findMatchingRecurrenceWithLong:", "findMatchingRecurrence", "Lorg.joda.time.tz.DateTimeZoneBuilder$Recurrence;", 0x2, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "serialVersionUID_DSTZone_", "serialVersionUID", 0x1a, "J", NULL, .constantValue.asLong = OrgJodaTimeTzDateTimeZoneBuilder_DSTZone_serialVersionUID },
    { "iStandardOffset_", NULL, 0x10, "I", NULL,  },
    { "iStartRecurrence_", NULL, 0x10, "Lorg.joda.time.tz.DateTimeZoneBuilder$Recurrence;", NULL,  },
    { "iEndRecurrence_", NULL, 0x10, "Lorg.joda.time.tz.DateTimeZoneBuilder$Recurrence;", NULL,  },
  };
  static J2ObjcClassInfo _OrgJodaTimeTzDateTimeZoneBuilder_DSTZone = { "DSTZone", "org.joda.time.tz", "DateTimeZoneBuilder", 0x1a, 11, methods, 4, fields, 0, NULL};
  return &_OrgJodaTimeTzDateTimeZoneBuilder_DSTZone;
}

@end

@implementation OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone

+ (OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *)readFromWithJavaIoDataInput:(id<JavaIoDataInput>)inArg
                                                                       withNSString:(NSString *)id_ {
  int poolSize = [((id<JavaIoDataInput>) nil_chk(inArg)) readUnsignedShort];
  IOSObjectArray *pool = [IOSObjectArray arrayWithLength:poolSize type:[IOSClass classWithClass:[NSString class]]];
  for (int i = 0; i < poolSize; i++) {
    (void) IOSObjectArray_Set(pool, i, [inArg readUTF]);
  }
  int size = [inArg readInt];
  IOSLongArray *transitions = [IOSLongArray arrayWithLength:size];
  IOSIntArray *wallOffsets = [IOSIntArray arrayWithLength:size];
  IOSIntArray *standardOffsets = [IOSIntArray arrayWithLength:size];
  IOSObjectArray *nameKeys = [IOSObjectArray arrayWithLength:size type:[IOSClass classWithClass:[NSString class]]];
  for (int i = 0; i < size; i++) {
    (*IOSLongArray_GetRef(transitions, i)) = [OrgJodaTimeTzDateTimeZoneBuilder readMillisWithJavaIoDataInput:inArg];
    (*IOSIntArray_GetRef(wallOffsets, i)) = (int) [OrgJodaTimeTzDateTimeZoneBuilder readMillisWithJavaIoDataInput:inArg];
    (*IOSIntArray_GetRef(standardOffsets, i)) = (int) [OrgJodaTimeTzDateTimeZoneBuilder readMillisWithJavaIoDataInput:inArg];
    @try {
      int index;
      if (poolSize < 256) {
        index = [inArg readUnsignedByte];
      }
      else {
        index = [inArg readUnsignedShort];
      }
      (void) IOSObjectArray_Set(nameKeys, i, IOSObjectArray_Get(pool, index));
    }
    @catch (JavaLangArrayIndexOutOfBoundsException *e) {
      @throw [[JavaIoIOException alloc] initWithNSString:@"Invalid encoding"];
    }
  }
  OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *tailZone = nil;
  if ([inArg readBoolean]) {
    tailZone = [OrgJodaTimeTzDateTimeZoneBuilder_DSTZone readFromWithJavaIoDataInput:inArg withNSString:id_];
  }
  return [[OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone alloc] initWithNSString:id_ withLongArray:transitions withIntArray:wallOffsets withIntArray:standardOffsets withNSStringArray:nameKeys withOrgJodaTimeTzDateTimeZoneBuilder_DSTZone:tailZone];
}

+ (OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *)createWithNSString:(NSString *)id_
                                                               withBoolean:(BOOL)outputID
                                                     withJavaUtilArrayList:(JavaUtilArrayList *)transitions
                              withOrgJodaTimeTzDateTimeZoneBuilder_DSTZone:(OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *)tailZone {
  int size = [((JavaUtilArrayList *) nil_chk(transitions)) size];
  if (size == 0) {
    @throw [[JavaLangIllegalArgumentException alloc] init];
  }
  IOSLongArray *trans = [IOSLongArray arrayWithLength:size];
  IOSIntArray *wallOffsets = [IOSIntArray arrayWithLength:size];
  IOSIntArray *standardOffsets = [IOSIntArray arrayWithLength:size];
  IOSObjectArray *nameKeys = [IOSObjectArray arrayWithLength:size type:[IOSClass classWithClass:[NSString class]]];
  OrgJodaTimeTzDateTimeZoneBuilder_Transition *last = nil;
  for (int i = 0; i < size; i++) {
    OrgJodaTimeTzDateTimeZoneBuilder_Transition *tr = [transitions getWithInt:i];
    if (![((OrgJodaTimeTzDateTimeZoneBuilder_Transition *) nil_chk(tr)) isTransitionFromWithOrgJodaTimeTzDateTimeZoneBuilder_Transition:last]) {
      @throw [[JavaLangIllegalArgumentException alloc] initWithNSString:id_];
    }
    (*IOSLongArray_GetRef(trans, i)) = [tr getMillis];
    (*IOSIntArray_GetRef(wallOffsets, i)) = [tr getWallOffset];
    (*IOSIntArray_GetRef(standardOffsets, i)) = [tr getStandardOffset];
    (void) IOSObjectArray_Set(nameKeys, i, [tr getNameKey]);
    last = tr;
  }
  IOSObjectArray *zoneNameData = [IOSObjectArray arrayWithLength:5 type:[IOSClass classWithClass:[NSString class]]];
  IOSObjectArray *zoneStrings = [((JavaTextDateFormatSymbols *) [[JavaTextDateFormatSymbols alloc] initWithJavaUtilLocale:JavaUtilLocale_get_ENGLISH_()]) getZoneStrings];
  for (int j = 0; j < (int) [((IOSObjectArray *) nil_chk(zoneStrings)) count]; j++) {
    IOSObjectArray *set = IOSObjectArray_Get(zoneStrings, j);
    if (set != nil && (int) [set count] == 5 && [((NSString *) nil_chk(id_)) isEqual:IOSObjectArray_Get(set, 0)]) {
      zoneNameData = set;
    }
  }
  OrgJodaTimeChronology *chrono = [OrgJodaTimeChronoISOChronology getInstanceUTC];
  for (int i = 0; i < (int) [nameKeys count] - 1; i++) {
    NSString *curNameKey = IOSObjectArray_Get(nameKeys, i);
    NSString *nextNameKey = IOSObjectArray_Get(nameKeys, i + 1);
    long long int curOffset = IOSIntArray_Get(wallOffsets, i);
    long long int nextOffset = IOSIntArray_Get(wallOffsets, i + 1);
    long long int curStdOffset = IOSIntArray_Get(standardOffsets, i);
    long long int nextStdOffset = IOSIntArray_Get(standardOffsets, i + 1);
    OrgJodaTimePeriod *p = [[OrgJodaTimePeriod alloc] initWithLong:IOSLongArray_Get(trans, i) withLong:IOSLongArray_Get(trans, i + 1) withOrgJodaTimePeriodType:[OrgJodaTimePeriodType yearMonthDay] withOrgJodaTimeChronology:chrono];
    if (curOffset != nextOffset && curStdOffset == nextStdOffset && [((NSString *) nil_chk(curNameKey)) isEqual:nextNameKey] && [p getYears] == 0 && [p getMonths] > 4 && [p getMonths] < 8 && [curNameKey isEqual:IOSObjectArray_Get(zoneNameData, 2)] && [curNameKey isEqual:IOSObjectArray_Get(zoneNameData, 4)]) {
      if ([OrgJodaTimeTzZoneInfoCompiler verbose]) {
        [((JavaIoPrintStream *) nil_chk(JavaLangSystem_get_out_())) printlnWithNSString:[NSString stringWithFormat:@"Fixing duplicate name key - %@", nextNameKey]];
        [JavaLangSystem_get_out_() printlnWithNSString:[NSString stringWithFormat:@"     - %@ - %@", [[OrgJodaTimeDateTime alloc] initWithLong:IOSLongArray_Get(trans, i) withOrgJodaTimeChronology:chrono], [[OrgJodaTimeDateTime alloc] initWithLong:IOSLongArray_Get(trans, i + 1) withOrgJodaTimeChronology:chrono]]];
      }
      if (curOffset > nextOffset) {
        (void) IOSObjectArray_Set(nameKeys, i, [([NSString stringWithFormat:@"%@-Summer", curNameKey]) intern]);
      }
      else if (curOffset < nextOffset) {
        (void) IOSObjectArray_Set(nameKeys, i + 1, [([NSString stringWithFormat:@"%@-Summer", nextNameKey]) intern]);
        i++;
      }
    }
  }
  if (tailZone != nil) {
    if ([((NSString *) nil_chk([((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(tailZone->iStartRecurrence_)) getNameKey])) isEqual:[((OrgJodaTimeTzDateTimeZoneBuilder_Recurrence *) nil_chk(tailZone->iEndRecurrence_)) getNameKey]]) {
      if ([OrgJodaTimeTzZoneInfoCompiler verbose]) {
        [((JavaIoPrintStream *) nil_chk(JavaLangSystem_get_out_())) printlnWithNSString:[NSString stringWithFormat:@"Fixing duplicate recurrent name key - %@", [tailZone->iStartRecurrence_ getNameKey]]];
      }
      if ([tailZone->iStartRecurrence_ getSaveMillis] > 0) {
        tailZone = [[OrgJodaTimeTzDateTimeZoneBuilder_DSTZone alloc] initWithNSString:[tailZone getID] withInt:tailZone->iStandardOffset_ withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:[tailZone->iStartRecurrence_ renameAppendWithNSString:@"-Summer"] withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:tailZone->iEndRecurrence_];
      }
      else {
        tailZone = [[OrgJodaTimeTzDateTimeZoneBuilder_DSTZone alloc] initWithNSString:[tailZone getID] withInt:tailZone->iStandardOffset_ withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:tailZone->iStartRecurrence_ withOrgJodaTimeTzDateTimeZoneBuilder_Recurrence:[tailZone->iEndRecurrence_ renameAppendWithNSString:@"-Summer"]];
      }
    }
  }
  return [[OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone alloc] initWithNSString:(outputID ? id_ : @"") withLongArray:trans withIntArray:wallOffsets withIntArray:standardOffsets withNSStringArray:nameKeys withOrgJodaTimeTzDateTimeZoneBuilder_DSTZone:tailZone];
}

- (instancetype)initWithNSString:(NSString *)id_
                   withLongArray:(IOSLongArray *)transitions
                    withIntArray:(IOSIntArray *)wallOffsets
                    withIntArray:(IOSIntArray *)standardOffsets
               withNSStringArray:(IOSObjectArray *)nameKeys
withOrgJodaTimeTzDateTimeZoneBuilder_DSTZone:(OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *)tailZone {
  if (self = [super initWithNSString:id_]) {
    iTransitions_ = transitions;
    iWallOffsets_ = wallOffsets;
    iStandardOffsets_ = standardOffsets;
    iNameKeys_ = nameKeys;
    iTailZone_ = tailZone;
  }
  return self;
}

- (NSString *)getNameKeyWithLong:(long long int)instant {
  IOSLongArray *transitions = iTransitions_;
  int i = [JavaUtilArrays binarySearchWithLongArray:transitions withLong:instant];
  if (i >= 0) {
    return IOSObjectArray_Get(nil_chk(iNameKeys_), i);
  }
  i = ~i;
  if (i < (int) [((IOSLongArray *) nil_chk(transitions)) count]) {
    if (i > 0) {
      return IOSObjectArray_Get(nil_chk(iNameKeys_), i - 1);
    }
    return @"UTC";
  }
  if (iTailZone_ == nil) {
    return IOSObjectArray_Get(nil_chk(iNameKeys_), i - 1);
  }
  return [((OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *) nil_chk(iTailZone_)) getNameKeyWithLong:instant];
}

- (int)getOffsetWithLong:(long long int)instant {
  IOSLongArray *transitions = iTransitions_;
  int i = [JavaUtilArrays binarySearchWithLongArray:transitions withLong:instant];
  if (i >= 0) {
    return IOSIntArray_Get(nil_chk(iWallOffsets_), i);
  }
  i = ~i;
  if (i < (int) [((IOSLongArray *) nil_chk(transitions)) count]) {
    if (i > 0) {
      return IOSIntArray_Get(nil_chk(iWallOffsets_), i - 1);
    }
    return 0;
  }
  if (iTailZone_ == nil) {
    return IOSIntArray_Get(nil_chk(iWallOffsets_), i - 1);
  }
  return [((OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *) nil_chk(iTailZone_)) getOffsetWithLong:instant];
}

- (int)getStandardOffsetWithLong:(long long int)instant {
  IOSLongArray *transitions = iTransitions_;
  int i = [JavaUtilArrays binarySearchWithLongArray:transitions withLong:instant];
  if (i >= 0) {
    return IOSIntArray_Get(nil_chk(iStandardOffsets_), i);
  }
  i = ~i;
  if (i < (int) [((IOSLongArray *) nil_chk(transitions)) count]) {
    if (i > 0) {
      return IOSIntArray_Get(nil_chk(iStandardOffsets_), i - 1);
    }
    return 0;
  }
  if (iTailZone_ == nil) {
    return IOSIntArray_Get(nil_chk(iStandardOffsets_), i - 1);
  }
  return [((OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *) nil_chk(iTailZone_)) getStandardOffsetWithLong:instant];
}

- (BOOL)isFixed {
  return NO;
}

- (long long int)nextTransitionWithLong:(long long int)instant {
  IOSLongArray *transitions = iTransitions_;
  int i = [JavaUtilArrays binarySearchWithLongArray:transitions withLong:instant];
  i = (i >= 0) ? (i + 1) : ~i;
  if (i < (int) [((IOSLongArray *) nil_chk(transitions)) count]) {
    return IOSLongArray_Get(transitions, i);
  }
  if (iTailZone_ == nil) {
    return instant;
  }
  long long int end = IOSLongArray_Get(transitions, (int) [transitions count] - 1);
  if (instant < end) {
    instant = end;
  }
  return [((OrgJodaTimeTzDateTimeZoneBuilder_DSTZone *) nil_chk(iTailZone_)) nextTransitionWithLong:instant];
}

- (long long int)previousTransitionWithLong:(long long int)instant {
  IOSLongArray *transitions = iTransitions_;
  int i = [JavaUtilArrays binarySearchWithLongArray:transitions withLong:instant];
  if (i >= 0) {
    if (instant > JavaLangLong_MIN_VALUE) {
      return instant - 1;
    }
    return instant;
  }
  i = ~i;
  if (i < (int) [((IOSLongArray *) nil_chk(transitions)) count]) {
    if (i > 0) {
      long long int prev = IOSLongArray_Get(transitions, i - 1);
      if (prev > JavaLangLong_MIN_VALUE) {
        return prev - 1;
      }
    }
    return instant;
  }
  if (iTailZone_ != nil) {
    long long int prev = [iTailZone_ previousTransitionWithLong:instant];
    if (prev < instant) {
      return prev;
    }
  }
  long long int prev = IOSLongArray_Get(transitions, i - 1);
  if (prev > JavaLangLong_MIN_VALUE) {
    return prev - 1;
  }
  return instant;
}

- (BOOL)isEqual:(id)obj {
  if (self == obj) {
    return YES;
  }
  if ([obj isKindOfClass:[OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone class]]) {
    OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *other = (OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *) check_class_cast(obj, [OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone class]);
    return [((NSString *) nil_chk([self getID])) isEqual:[((OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *) nil_chk(other)) getID]] && [JavaUtilArrays equalsWithLongArray:iTransitions_ withLongArray:other->iTransitions_] && [JavaUtilArrays equalsWithNSObjectArray:iNameKeys_ withNSObjectArray:other->iNameKeys_] && [JavaUtilArrays equalsWithIntArray:iWallOffsets_ withIntArray:other->iWallOffsets_] && [JavaUtilArrays equalsWithIntArray:iStandardOffsets_ withIntArray:other->iStandardOffsets_] && ((iTailZone_ == nil) ? (nil == other->iTailZone_) : ([iTailZone_ isEqual:other->iTailZone_]));
  }
  return NO;
}

- (void)writeToWithJavaIoDataOutput:(id<JavaIoDataOutput>)outArg {
  int size = (int) [((IOSLongArray *) nil_chk(iTransitions_)) count];
  id<JavaUtilSet> poolSet = [[JavaUtilHashSet alloc] init];
  for (int i = 0; i < size; i++) {
    [poolSet addWithId:IOSObjectArray_Get(nil_chk(iNameKeys_), i)];
  }
  int poolSize = [poolSet size];
  if (poolSize > 65535) {
    @throw [[JavaLangUnsupportedOperationException alloc] initWithNSString:@"String pool is too large"];
  }
  IOSObjectArray *pool = [IOSObjectArray arrayWithLength:poolSize type:[IOSClass classWithClass:[NSString class]]];
  id<JavaUtilIterator> it = [poolSet iterator];
  for (int i = 0; [((id<JavaUtilIterator>) nil_chk(it)) hasNext]; i++) {
    (void) IOSObjectArray_Set(pool, i, [it next]);
  }
  [((id<JavaIoDataOutput>) nil_chk(outArg)) writeShortWithInt:poolSize];
  for (int i = 0; i < poolSize; i++) {
    [outArg writeUTFWithNSString:IOSObjectArray_Get(pool, i)];
  }
  [outArg writeIntWithInt:size];
  for (int i = 0; i < size; i++) {
    [OrgJodaTimeTzDateTimeZoneBuilder writeMillisWithJavaIoDataOutput:outArg withLong:IOSLongArray_Get(iTransitions_, i)];
    [OrgJodaTimeTzDateTimeZoneBuilder writeMillisWithJavaIoDataOutput:outArg withLong:IOSIntArray_Get(nil_chk(iWallOffsets_), i)];
    [OrgJodaTimeTzDateTimeZoneBuilder writeMillisWithJavaIoDataOutput:outArg withLong:IOSIntArray_Get(nil_chk(iStandardOffsets_), i)];
    NSString *nameKey = IOSObjectArray_Get(nil_chk(iNameKeys_), i);
    for (int j = 0; j < poolSize; j++) {
      if ([((NSString *) nil_chk(IOSObjectArray_Get(pool, j))) isEqual:nameKey]) {
        if (poolSize < 256) {
          [outArg writeByteWithInt:j];
        }
        else {
          [outArg writeShortWithInt:j];
        }
        break;
      }
    }
  }
  [outArg writeBooleanWithBoolean:iTailZone_ != nil];
  if (iTailZone_ != nil) {
    [iTailZone_ writeToWithJavaIoDataOutput:outArg];
  }
}

- (BOOL)isCachable {
  if (iTailZone_ != nil) {
    return YES;
  }
  IOSLongArray *transitions = iTransitions_;
  if ((int) [((IOSLongArray *) nil_chk(transitions)) count] <= 1) {
    return NO;
  }
  double distances = 0;
  int count = 0;
  for (int i = 1; i < (int) [transitions count]; i++) {
    long long int diff = IOSLongArray_Get(transitions, i) - IOSLongArray_Get(transitions, i - 1);
    if (diff < ((366LL + 365) * 24 * 60 * 60 * 1000)) {
      distances += (double) diff;
      count++;
    }
  }
  if (count > 0) {
    double avg = distances / count;
    avg /= 24 * 60 * 60 * 1000;
    if (avg >= 25) {
      return YES;
    }
  }
  return NO;
}

- (void)copyAllFieldsTo:(OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone *)other {
  [super copyAllFieldsTo:other];
  other->iNameKeys_ = iNameKeys_;
  other->iStandardOffsets_ = iStandardOffsets_;
  other->iTailZone_ = iTailZone_;
  other->iTransitions_ = iTransitions_;
  other->iWallOffsets_ = iWallOffsets_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "readFromWithJavaIoDataInput:withNSString:", "readFrom", "Lorg.joda.time.tz.DateTimeZoneBuilder$PrecalculatedZone;", 0x8, "Ljava.io.IOException;" },
    { "createWithNSString:withBoolean:withJavaUtilArrayList:withOrgJodaTimeTzDateTimeZoneBuilder_DSTZone:", "create", "Lorg.joda.time.tz.DateTimeZoneBuilder$PrecalculatedZone;", 0x8, NULL },
    { "initWithNSString:withLongArray:withIntArray:withIntArray:withNSStringArray:withOrgJodaTimeTzDateTimeZoneBuilder_DSTZone:", "PrecalculatedZone", NULL, 0x2, NULL },
    { "getNameKeyWithLong:", "getNameKey", "Ljava.lang.String;", 0x1, NULL },
    { "getOffsetWithLong:", "getOffset", "I", 0x1, NULL },
    { "getStandardOffsetWithLong:", "getStandardOffset", "I", 0x1, NULL },
    { "isFixed", NULL, "Z", 0x1, NULL },
    { "nextTransitionWithLong:", "nextTransition", "J", 0x1, NULL },
    { "previousTransitionWithLong:", "previousTransition", "J", 0x1, NULL },
    { "isEqual:", "equals", "Z", 0x1, NULL },
    { "writeToWithJavaIoDataOutput:", "writeTo", "V", 0x1, "Ljava.io.IOException;" },
    { "isCachable", NULL, "Z", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "serialVersionUID_PrecalculatedZone_", "serialVersionUID", 0x1a, "J", NULL, .constantValue.asLong = OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone_serialVersionUID },
    { "iTransitions_", NULL, 0x12, "[J", NULL,  },
    { "iWallOffsets_", NULL, 0x12, "[I", NULL,  },
    { "iStandardOffsets_", NULL, 0x12, "[I", NULL,  },
    { "iNameKeys_", NULL, 0x12, "[Ljava.lang.String;", NULL,  },
    { "iTailZone_", NULL, 0x12, "Lorg.joda.time.tz.DateTimeZoneBuilder$DSTZone;", NULL,  },
  };
  static J2ObjcClassInfo _OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone = { "PrecalculatedZone", "org.joda.time.tz", "DateTimeZoneBuilder", 0x1a, 12, methods, 6, fields, 0, NULL};
  return &_OrgJodaTimeTzDateTimeZoneBuilder_PrecalculatedZone;
}

@end
